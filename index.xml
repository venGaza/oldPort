<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>venGaza</title>
    <link>https://vengaza.github.io/</link>
      <atom:link href="https://vengaza.github.io/index.xml" rel="self" type="application/rss+xml" />
    <description>venGaza</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><lastBuildDate>Mon, 22 Jun 2020 00:31:21 -0500</lastBuildDate>
    <image>
      <url>https://vengaza.github.io/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png</url>
      <title>venGaza</title>
      <link>https://vengaza.github.io/</link>
    </image>
    
    <item>
      <title>Invitation</title>
      <link>https://vengaza.github.io/ctf/googlectf2019/001invitation/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>https://vengaza.github.io/ctf/googlectf2019/001invitation/</guid>
      <description>&lt;p&gt;You are a simple life form, exiled from your home planet and in search of a new place to call home. The ruling came fast. Your taste in music was deemed to be far too &amp;ldquo;out-there-man&amp;rdquo; for anyone to possibly associate with you anymore. You were given 60 revolutions of Xenon around Fir to leave and never return. Gather whatever possessions and leave. You find your parents music collection, oddly in it is a golden disc labelled &amp;ldquo;Property of NASA, if lost please return to: EVNJAKL 1600 Ampitheatre Parkway Mountain View California.&amp;rdquo; The music on the disc was uncovered a while back and was not very interesting. This weird language that said something about &amp;ldquo;Peace, love and rock and roll. Also we&amp;rsquo;re having a really cool party tonight, so for whoever is out there, bring a friend and come along! Co-ordinates enclosed.&amp;rdquo; On the back the words &amp;ldquo;Draft, do not distribute or load onto probe&amp;rdquo; written in big red letters. That could mean anything.&lt;/p&gt;
&lt;p&gt;You&amp;rsquo;ll go, since you have nowhere else to go. But you&amp;rsquo;ll be careful. You well know to learn all you can about alien beings before making contact. They could be hostile, or listen to boring music. Time is slipping away fast, you race aboard the nearest ObarPool Spaceship. But you&amp;rsquo;ve never driven one&amp;hellip; what next genius?&lt;/p&gt;
&lt;h2 id=&#34;task-enter-space-time-coordinates-misc&#34;&gt;Task: Enter Space-Time Coordinates (Misc)&lt;/h2&gt;
&lt;p&gt;Ok well done. The console is on. It&amp;rsquo;s asking for coordinates. Beating heavily on the console yields little results, but the only time anything changes on your display is when you put in numbers.. So what numbers are you going to go for?  You see the starship&amp;rsquo;s logs, but is there a manual? Or should you just keep beating the console?&lt;/p&gt;
&lt;p&gt;
&lt;a href=&#34;https://storage.googleapis.com/gctf-2019-attachments/00c2a73eec8abb4afb9c3ef3a161b64b451446910535bfc0cc81c2b04aa132ed&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Task Files&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;p&gt;Go ahead and download the Task Files and navigate to the folder in your command line client (I&amp;rsquo;ll be using Linux). Using the &lt;code&gt;ls&lt;/code&gt; command, we&amp;rsquo;ll list out the files to determine what we have to work with. In this task, we are given two files: a .txt file and an executable binary.&lt;/p&gt;





  











&lt;figure id=&#34;figure-list-out-files-using-ls&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/googlectf2019/001invitation/sol1.png&#34; data-caption=&#34;List out files using ls&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/googlectf2019/001invitation/sol1.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    List out files using ls
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;Let&amp;rsquo;s go ahead and check what is in the text file. We&amp;rsquo;ll use the &lt;code&gt;cat&lt;/code&gt; command to print out the contents of the text tile to the console. Unfortunately, there does not seem to be anything of note here.&lt;/p&gt;





  











&lt;figure id=&#34;figure-run-cat-output-of-logtxt&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/googlectf2019/001invitation/sol2.png&#34; data-caption=&#34;Run CAT output of log.txt&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/googlectf2019/001invitation/sol2.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Run CAT output of log.txt
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;Next, we will go ahead and execute the binary(If you do not have execute permission, run the following command &lt;code&gt;chmod +x&lt;/code&gt;). It looks like this binary is the menu interface for the spaceship. Incidentally, the CTF destination is redacted and we get an error message when we input coordinates.&lt;/p&gt;





  











&lt;figure id=&#34;figure-run-the-binary-file&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/googlectf2019/001invitation/sol3.png&#34; data-caption=&#34;Run the binary file&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/googlectf2019/001invitation/sol3.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Run the binary file
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;Exit out of the program with &lt;code&gt;^c&lt;/code&gt;. Let&amp;rsquo;s see if we can brute force the flag out of the binary by running the &lt;code&gt;strings&lt;/code&gt; command on the &lt;code&gt;./rand2&lt;/code&gt; binary. This technique allows us to parse out the plain text from a binary file. We see that there are plenty of plain text strings within this file, so we need a fast way to search through.&lt;/p&gt;





  











&lt;figure id=&#34;figure-run-strings&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/googlectf2019/001invitation/sol4.png&#34; data-caption=&#34;Run strings&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/googlectf2019/001invitation/sol4.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Run strings
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;Fortunately, GREP will come to the rescue. We&amp;rsquo;ll pipe the output of strings into grep input using the following command &lt;code&gt;strings ./rand2 | grep flag&lt;/code&gt;. There is our flag!&lt;/p&gt;





  











&lt;figure id=&#34;figure-grep-the-strings-output&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/googlectf2019/001invitation/sol5.png&#34; data-caption=&#34;Grep the strings output&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/googlectf2019/001invitation/sol5.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Grep the strings output
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;Flag:  &lt;code&gt;CTF{welcome_to_googlectf}&lt;/code&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Invitation</title>
      <link>https://vengaza.github.io/ctf/hackthebox/001invitation/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>https://vengaza.github.io/ctf/hackthebox/001invitation/</guid>
      <description>&lt;p&gt;You are a simple life form, exiled from your home planet and in search of a new place to call home. The ruling came fast. Your taste in music was deemed to be far too &amp;ldquo;out-there-man&amp;rdquo; for anyone to possibly associate with you anymore. You were given 60 revolutions of Xenon around Fir to leave and never return. Gather whatever possessions and leave. You find your parents music collection, oddly in it is a golden disc labelled &amp;ldquo;Property of NASA, if lost please return to: EVNJAKL 1600 Ampitheatre Parkway Mountain View California.&amp;rdquo; The music on the disc was uncovered a while back and was not very interesting. This weird language that said something about &amp;ldquo;Peace, love and rock and roll. Also we&amp;rsquo;re having a really cool party tonight, so for whoever is out there, bring a friend and come along! Co-ordinates enclosed.&amp;rdquo; On the back the words &amp;ldquo;Draft, do not distribute or load onto probe&amp;rdquo; written in big red letters. That could mean anything.&lt;/p&gt;
&lt;p&gt;You&amp;rsquo;ll go, since you have nowhere else to go. But you&amp;rsquo;ll be careful. You well know to learn all you can about alien beings before making contact. They could be hostile, or listen to boring music. Time is slipping away fast, you race aboard the nearest ObarPool Spaceship. But you&amp;rsquo;ve never driven one&amp;hellip; what next genius?&lt;/p&gt;
&lt;h2 id=&#34;task-enter-space-time-coordinates-misc&#34;&gt;Task: Enter Space-Time Coordinates (Misc)&lt;/h2&gt;
&lt;p&gt;Ok well done. The console is on. It&amp;rsquo;s asking for coordinates. Beating heavily on the console yields little results, but the only time anything changes on your display is when you put in numbers.. So what numbers are you going to go for?  You see the starship&amp;rsquo;s logs, but is there a manual? Or should you just keep beating the console?&lt;/p&gt;
&lt;p&gt;
&lt;a href=&#34;https://storage.googleapis.com/gctf-2019-attachments/00c2a73eec8abb4afb9c3ef3a161b64b451446910535bfc0cc81c2b04aa132ed&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Task Files&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
</description>
    </item>
    
    <item>
      <title>Task 1</title>
      <link>https://vengaza.github.io/ctf/nsacodebreaker2019/001task1/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>https://vengaza.github.io/ctf/nsacodebreaker2019/001task1/</guid>
      <description>&lt;h2 id=&#34;it-begins&#34;&gt;It Begins!&lt;/h2&gt;
&lt;p&gt;Category: Network Traffic Analysis&lt;/p&gt;
&lt;p&gt;There are many challenges that we will need to overcome in order to exploit TerrorTime. The first is that we do not yet have a copy of it. We have learned few details through intelligence sources, but the terrorists have managed to keep the app hidden. It is not publicly available on any App Store. Fortunately, as part of a recent military operation, specialized collection gear was forward deployed near the terrorist&amp;rsquo;s area of operations. This resulted in a trove of collected traffic and we need your help to analyze it. Your first task is to find and extract a copy of the TerrorTime Android Package (APK) file from the packet capture. Submit the APK&amp;rsquo;s SHA256 hash. This will help us search other intelligence sources for connections to users. To test out the app, we also need the registration information their leadership uses to register each client. Analyze the packet capture for this data and submit the registration information for 2 clients (in any order).&lt;/p&gt;
&lt;h3 id=&#34;flags&#34;&gt;Flags&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; SHA256 Hash of the Terrotime APK (Hexadecimal/Base16 encoded)&lt;/li&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; Client IDs and Secrets (one pair of credentials per line, separated by colon)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
&lt;a href=&#34;https://codebreaker.ltsnet.net/files/task1/terrortime.pcapng?1593563870&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Task Files&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;h3 id=&#34;commands&#34;&gt;Commands&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;cat&lt;/code&gt; - read and conCATenate files (Linux/OSX)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sha256sum&lt;/code&gt; - compute and check SHA256 message digest (Linux/OSX)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;File-GetHash&lt;/code&gt; - compute and check SHA256 message digest (Windows)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;tools&#34;&gt;Tools&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href=&#34;https://www.wireshark.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WireShark&lt;/a&gt; - Network Protocol Analyzer&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;analysis&#34;&gt;Analysis&lt;/h3&gt;
&lt;p&gt;In this challenge, we are given a &lt;code&gt;.pcapng&lt;/code&gt; file which is a packet capture format that contains a dump of data packets caught over a network. We will use &lt;mark&gt;WireShark&lt;/mark&gt;, a network protocol analyzer, to open this file and view the captured data packets.&lt;/p&gt;





  











&lt;figure id=&#34;figure-packets-in-wireshark&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/nsa2019/001task1/packets.png&#34; data-caption=&#34;Packets in wireshark&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/nsa2019/001task1/packets.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Packets in wireshark
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;Even though there are over 9000 packets in this dump, we immediately notice that the 4th packet stands out because the &amp;ldquo;terrorTime&amp;rdquo; name is mentioned in its information section. This packet was sent using an application layer protocol called &lt;code&gt;HTTP&lt;/code&gt;. Let&amp;rsquo;s use a Wireshark filter to reduce the noise and list only the packets using the HTTP protocol.&lt;/p&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    If the HTTP packet had not been so obvious, another technique would have been to checkout the protocol hierarchy of the dump: &lt;code&gt;STATISTICS &amp;gt; PROTOCOL HIERARCHY&lt;/code&gt;. This is an excellent tool to use to gain more insight into the dump when looking for clues.
  &lt;/div&gt;
&lt;/div&gt;





  











&lt;figure id=&#34;figure-http-packets-in-wireshark&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/nsa2019/001task1/httpPackets.png&#34; data-caption=&#34;HTTP Packets in wireshark&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/nsa2019/001task1/httpPackets.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    HTTP Packets in wireshark
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;~9000 packets have now been reduced to 4! There are 2 GET requests with 2 responses which seem to have file objects associated with them. The first file is the missing APK. The other seems to be a text document. We&amp;rsquo;ll extract and save these files with WireShark: &lt;code&gt;FILE &amp;gt; EXPORT OBJECTS &amp;gt; HTTP &amp;gt; SAVE&lt;/code&gt;.&lt;/p&gt;





  











&lt;figure id=&#34;figure-extracting-the-http-files&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/nsa2019/001task1/files.png&#34; data-caption=&#34;Extracting the http files&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/nsa2019/001task1/files.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Extracting the http files
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;With the &lt;code&gt;terrortime.apk&lt;/code&gt; in hand, we can now run the &lt;code&gt;sha256sum&lt;/code&gt; command on the APK file to determine its hash value and complete the first task.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ sha256sum terrortime.apk
65f87dfb701694d5b72963e6b707fda6882de72612af59296c255bef00a3699e  terrortime.apk 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We also need to locate the registration information for 2 clients. Let&amp;rsquo;s investigate the &lt;code&gt;README.developer&lt;/code&gt; file we extracted earlier to see if there are any hints. This file can be opened up using a text editor or you use the &lt;code&gt;cat&lt;/code&gt; command to print the file out to the terminal.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ cat README.developer
------------------
terrorTime.apk -- Most current version of terrortime APK for android mobile devices
ava--vhost-10@terrortime.app -- First Terrortime test account client id
emmett--vhost-10@terrortime.app -- Second Terrortime test account client id
7rIFNGekGSE6Ai -- First Terrortime test account client secret
BJMwJzGTkKDgB2 -- Second Terrortime test account client secret

Used above client information for testing. See test report in Master.

Dev bobs comments on most recent APK code changes
---------------------------------------------------
(20190613) Beta version of Terrortime app completed. Successfully tested. Waiting for customer feedback.

(20190723) Had to make some notable changes to Terrortime authentication mechanisms based on new Customer requirements (as of this week). Code changes were just committed to Master. Not pretty, but will support future operational needs (didnt ask ...dont want to know the details).

Changes also support recently clarified deployment/use CONOP. App will be installed and pre-configured on mobile device before device is given to associate. Associate must use app as configured to interact with Terrortime chat service and will not be provided plaintext version of credentials required for part of authentication process. App will use its credentials to authenticate itself to Terrortime infrastructure, a process that will be transparent to user/associate. Associate will be provided a PIN that allows him/her to open Terrortime app. 

See design documentation in Master README file for details.

(20190725) After a few bug fixes, Terrortime app passed testing. No rest for the weary.

(20190726) Packaged up and ready to ship! $$$$
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Luckily, the information we are looking for is revealed within this file with 2 accounts listed along with the client secrets. How convenient 😄&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Arrival &amp; Reconnaissance</title>
      <link>https://vengaza.github.io/ctf/googlectf2019/002arrivalrecon/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>https://vengaza.github.io/ctf/googlectf2019/002arrivalrecon/</guid>
      <description>&lt;p&gt;Having successfully figured out this &amp;ldquo;coordinate&amp;rdquo; problem. The ship lurches forward violently into space. This is one of the moments when you realize that some kind of thought or plan would have been good, but typically for you and how you found yourself in this situation, you didn&amp;rsquo;t think too much before acting. Only the stars themselves know where you&amp;rsquo;ll end up.&lt;/p&gt;
&lt;p&gt;After what seems like an eternity, or at least one full season of &amp;ldquo;Xenon&amp;rsquo;s Next Top Galactic Overlord&amp;rdquo; you arrive in a system of 9 planetary bodies, though one of them is exceptionally small. You nostalgically remember playing explodatoid with your friends and hunting down planets like this. But this small planet registers a hive of noise and activity on your ships automated scanners. There&amp;rsquo;s things there! Billions upon trillions of things, moving around, flying, swimming, sliding, falling.&lt;/p&gt;
&lt;p&gt;Of particular interest may be the insect-like creatures flying around this planet, uniformly. One has the words &amp;ldquo;Osmium Satellites&amp;rdquo; written on it. Maybe this is a starting point to get to know what&amp;rsquo;s ahead of you.&lt;/p&gt;
&lt;h2 id=&#34;task-satellite-networking&#34;&gt;Task: Satellite (Networking)&lt;/h2&gt;
&lt;p&gt;Placing your ship in range of the Osmiums, you begin to receive signals. Hoping that you are not detected, because it&amp;rsquo;s too late now, you figure that it may be worth finding out what these signals mean and what information might be &amp;ldquo;borrowed&amp;rdquo; from them. Can you hear me Captain Tim? Floating in your tin can there? Your tin can has a wire to ground control?&lt;/p&gt;
&lt;p&gt;Find something to do that isn&amp;rsquo;t staring at the Blue Planet.&lt;/p&gt;
&lt;p&gt;
&lt;a href=&#34;https://storage.googleapis.com/gctf-2019-attachments/768be4f10429f613eb27fa3e3937fe21c7581bdca97d6909e070ab6f7dbf2fbf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Task Files&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
</description>
    </item>
    
    <item>
      <title>Arrival &amp; Reconnaissance</title>
      <link>https://vengaza.github.io/ctf/hackthebox/002arrivalrecon/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>https://vengaza.github.io/ctf/hackthebox/002arrivalrecon/</guid>
      <description>&lt;p&gt;Having successfully figured out this &amp;ldquo;coordinate&amp;rdquo; problem. The ship lurches forward violently into space. This is one of the moments when you realize that some kind of thought or plan would have been good, but typically for you and how you found yourself in this situation, you didn&amp;rsquo;t think too much before acting. Only the stars themselves know where you&amp;rsquo;ll end up.&lt;/p&gt;
&lt;p&gt;After what seems like an eternity, or at least one full season of &amp;ldquo;Xenon&amp;rsquo;s Next Top Galactic Overlord&amp;rdquo; you arrive in a system of 9 planetary bodies, though one of them is exceptionally small. You nostalgically remember playing explodatoid with your friends and hunting down planets like this. But this small planet registers a hive of noise and activity on your ships automated scanners. There&amp;rsquo;s things there! Billions upon trillions of things, moving around, flying, swimming, sliding, falling.&lt;/p&gt;
&lt;p&gt;Of particular interest may be the insect-like creatures flying around this planet, uniformly. One has the words &amp;ldquo;Osmium Satellites&amp;rdquo; written on it. Maybe this is a starting point to get to know what&amp;rsquo;s ahead of you.&lt;/p&gt;
&lt;h2 id=&#34;task-satellite-networking&#34;&gt;Task: Satellite (Networking)&lt;/h2&gt;
&lt;p&gt;Placing your ship in range of the Osmiums, you begin to receive signals. Hoping that you are not detected, because it&amp;rsquo;s too late now, you figure that it may be worth finding out what these signals mean and what information might be &amp;ldquo;borrowed&amp;rdquo; from them. Can you hear me Captain Tim? Floating in your tin can there? Your tin can has a wire to ground control?&lt;/p&gt;
&lt;p&gt;Find something to do that isn&amp;rsquo;t staring at the Blue Planet.&lt;/p&gt;
&lt;p&gt;
&lt;a href=&#34;https://storage.googleapis.com/gctf-2019-attachments/768be4f10429f613eb27fa3e3937fe21c7581bdca97d6909e070ab6f7dbf2fbf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Task Files&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
</description>
    </item>
    
    <item>
      <title>Home</title>
      <link>https://vengaza.github.io/ctf/googlectf2019/003home/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>https://vengaza.github.io/ctf/googlectf2019/003home/</guid>
      <description>&lt;h2 id=&#34;task-home-computer-forensics&#34;&gt;Task: Home Computer (Forensics)&lt;/h2&gt;
&lt;p&gt;Blunderbussing your way through the decision making process, you figure that one is as good as the other and that further research into the importance of Work Life balance is of little interest to you. You&amp;rsquo;re the decider after all. You confidently use the credentials to access the &amp;ldquo;Home Computer.&amp;rdquo;&lt;/p&gt;
&lt;p&gt;Something called &amp;ldquo;desktop&amp;rdquo; presents itself, displaying a fascinating round and bumpy creature (much like yourself) labeled  &amp;ldquo;cauliflower 4 work - GAN post.&amp;rdquo;  Your 40 hearts skip a beat.  It looks somewhat like your neighbors on XiXaX3.   ..Ah XiXaX3&amp;hellip; You&amp;rsquo;d spend summers there at the beach, an awkward kid from ObarPool on a family vacation, yearning, but without nerve, to talk to those cool sophisticated locals.&lt;/p&gt;
&lt;p&gt;So are these &amp;ldquo;Cauliflowers&amp;rdquo; earthlings? Not at all the unrelatable bipeds you imagined them to be.  Will they be at the party?  Hopefully SarahH has left some other work data on her home computer for you to learn more.&lt;/p&gt;
&lt;p&gt;
&lt;a href=&#34;https://storage.googleapis.com/gctf-2019-attachments/86863db246859897dda6ba3a4f5801de9109d63c9b6b69810ec4182bf44c9b75&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Task Files&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
</description>
    </item>
    
    <item>
      <title>Task 2</title>
      <link>https://vengaza.github.io/ctf/nsacodebreaker2019/002task2/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>https://vengaza.github.io/ctf/nsacodebreaker2019/002task2/</guid>
      <description>&lt;h2 id=&#34;permissions&#34;&gt;Permissions&lt;/h2&gt;
&lt;p&gt;Category: Mobile APK Analysis&lt;/p&gt;
&lt;p&gt;The TerrorTime APK file contains metadata that describes various security properties of the application that we want to know. Since we now have a copy of the APK thanks to the military operation described in Task 1, we need you to identify and submit the following:&lt;/p&gt;
&lt;h3 id=&#34;flags&#34;&gt;Flags&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; App Permissions (Capital letters and underscores, one per line)&lt;/li&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; SHA256 of Signing Certificate (Hexadecimal/Base16 encoded)&lt;/li&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; Certificate Signer Name (ASCII)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Please note that completion of task 1 is required to complete this task.&lt;/p&gt;
&lt;p&gt;
&lt;a href=&#34;https://codebreaker.ltsnet.net/files/task2/terrortime.pcapng?1593563870&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Task Files&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;h3 id=&#34;commands&#34;&gt;Commands&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;apkanalyzer -h manifest permissions&lt;/code&gt; - Print application permissions&lt;/li&gt;
&lt;li&gt;&lt;code&gt;apksigner verify --print-certs&lt;/code&gt; - Print out APK certificate information&lt;/li&gt;
&lt;li&gt;&lt;code&gt;File-GetHash&lt;/code&gt; - compute and check SHA256 message digest (Windows)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;tools&#34;&gt;Tools&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href=&#34;https://developer.android.com/studio&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Android Studio&lt;/a&gt; - Google IDE for Android&lt;/li&gt;
&lt;li&gt;
&lt;a href=&#34;https://ghidra-sre.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ghidra&lt;/a&gt; - NSA&amp;rsquo;s software reverse engineering suite (Optional)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;analysis&#34;&gt;Analysis&lt;/h3&gt;
&lt;p&gt;In this challenge, we&amp;rsquo;ll continue analyzing the Terrortime APK we recovered in the previous challenge. We first need to figure out the application&amp;rsquo;s permissions. It is first important to understand what an APK file actually is.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Android Package (APK)[1] is the package file format used by the Android, and a number of other Android-based operating systems for distribution and installation of mobile apps, mobile games and middleware.&lt;/p&gt;
&lt;p&gt;&amp;ndash; &lt;cite&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Android_application_package&#34;&gt;https://en.wikipedia.org/wiki/Android_application_package&lt;/a&gt;&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;It is also important to realize that an APK is a compiled file meaning the source code (human readable) has been transformed into machine code (computer executable). This makes it difficult to do any meaningful analysis without first figuring out a way to decompile the file to make it human readable once again. A great tool for this was released by the NSA, &lt;mark&gt;Ghidra&lt;/mark&gt;. There are also other tools such JADX and APKtool. I will not be making use of these tools for this challenge, but they are important tools to be aware of when the need to reverse arises.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;* Tip: APK files can also be unzipped by changing the file extension from APK to ZIP.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;If we look at the objectives for this task, we should take notice that the information being requested
is just the application metadata (attributes) of the file itself which means there should be no need to decompile. We just need to figure out a way to view the metadata since this capability is not natively built into our operating system. Enter &lt;mark&gt;Android Studio&lt;/mark&gt;, Google&amp;rsquo;s official Android integrated development environment (IDE) which comes with a variety of tools to make the development of Android applications easier. We are specifically interested in the Android Software Development Kit (SDK) within Android Studio which provides access to some powerful command line tools to assist in our analysis.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;* Tip: Whenever doing an analysis on unfamiliar software, always check to see if an SDK exists and what tools the developers are using!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Because I have not spent any time developing Android applications, I had to go through the documentation to find tools for the task. The first command line tool I came across which seemed helpful was the &lt;code&gt;apkanalyzer&lt;/code&gt;. This package provides us with the &lt;code&gt;apkanalyzer -h manifest permissions&lt;/code&gt; command and allows us to print out the permissions for the APK file. Perfect!&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ apkanalyzer -h manifest permissions terrorTime.apk
$ android.permission.INTERNET
$ android.permission.ACCESS_NETWORK_STATE
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We now have the APK permissions, but what do these permissions actually mean? Upon further review of the Android documentation we discover:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ACCESS_NETWORK_STATE: Allows applications to access information about networks.&lt;br&gt;
INTERNET: Allows applications to open network sockets.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The next part of the task requires us to find certificate information. Luckily, there is another package within the Android SDK called &lt;code&gt;apksigner&lt;/code&gt;. This package provides us with the &lt;code&gt;apksigner verify --print-certs&lt;/code&gt; command and allows us to print out information about the APK&amp;rsquo;s signing certificates.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ apksigner verify --print-certs terrorTime.apk

Signer #1 certificate DN: CN=dev_terrorTime_378361, OU=TSuite
Signer #1 certificate SHA-256 digest: 2bcd16e90870731a7c298348ead84dc8403d16c63509b36fbc26e469fa697961
Signer #1 certificate SHA-1 digest: c4db0963ba6fb32b4c9f3515f71040e68f670685
Signer #1 certificate MD5 digest: 7fe6476d39c9fe7f81d32ccbf651eff2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As we can see, this command prints out the certificate information and provides both the SHA256 of the signing certificate and the common name (CN) of the developer who signed it.&lt;/p&gt;
&lt;div class=&#34;alert alert-warning&#34;&gt;
  &lt;div&gt;
    &lt;em&gt;* Note: Do not be discouraged if you were unable to get the Android SDK commands up and running. Admittedly, I ran into issues with the SDK not playing nice with the various versions of Java on my machine. This required some tinkering with my &lt;code&gt;.zshrc&lt;/code&gt; to make sure the right JDK version was being used.&lt;/em&gt;
  &lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Task 3</title>
      <link>https://vengaza.github.io/ctf/nsacodebreaker2019/003task3/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>https://vengaza.github.io/ctf/nsacodebreaker2019/003task3/</guid>
      <description>&lt;h2 id=&#34;turn-of-events&#34;&gt;Turn of Events&lt;/h2&gt;
&lt;p&gt;Category: Database Analysis&lt;/p&gt;
&lt;p&gt;Analysts found TerrorTime installed on a device that was taken from a terrorist arrested at a port of entry in the US. They were able to recover the SQLite database from the TerrorTime installation on the device, which should provide us with more in-depth knowledge about the terrorist&amp;rsquo;s communications and the TerrorTime infrastructure. Your goal for this task is to analyze the database and submit the addresses of the TerrorTime OAUTH (authentication) and XMPP (chat) servers.&lt;/p&gt;
&lt;h3 id=&#34;flags&#34;&gt;Flags&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; OAUTH IP Address&lt;/li&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; XMPP Server IP Address&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
&lt;a href=&#34;https://codebreaker.ltsnet.net/files/task3/clientDB.db?1593563870&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Task Files&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;h3 id=&#34;commands&#34;&gt;Commands&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;dig&lt;/code&gt; - Domain Information Groper, a DNS lookup utility&lt;/li&gt;
&lt;li&gt;&lt;code&gt;host&lt;/code&gt; - A utility to perform DNS lookups (Optional)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nslookup&lt;/code&gt; - Performs DNS queries (Optional)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ping&lt;/code&gt; - Send ICMP ECHO_REQUEST to network hosts (Optional)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;tools&#34;&gt;Tools&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href=&#34;https://sqlitebrowser.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;DB Browser for SQLite&lt;/a&gt; - Create, search and edit databases&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;analysis&#34;&gt;Analysis&lt;/h3&gt;
&lt;p&gt;In this challenge, we are presented with an SQLite database file and tasked with finding the IP (network) addresses of the OAUTH and XMPP servers. What is SQLite, OAUTH, and XMPP?&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;SQLite is a C-language library that implements a small, fast, self-contained, high-reliability, full-featured, SQL database engine. SQLite is the most used database engine in the world.&lt;/p&gt;
&lt;p&gt;&amp;ndash; &lt;cite&gt;&lt;a href=&#34;https://www.sqlite.org/index.html&#34;&gt;https://www.sqlite.org/index.html&lt;/a&gt;&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;OAUTH is an open protocol to allow secure authorization in a simple and standard method from web, mobile and desktop applications.&lt;/p&gt;
&lt;p&gt;&amp;ndash; &lt;cite&gt;&lt;a href=&#34;https://oauth.net/&#34;&gt;https://oauth.net/&lt;/a&gt;&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;XMPP is the Extensible Messaging and Presence Protocol, a set of open technologies for instant messaging, presence, multi-party chat, voice and video calls, collaboration, lightweight middleware, content syndication, and generalized routing of XML data.&lt;/p&gt;
&lt;p&gt;&amp;ndash; &lt;cite&gt;&lt;a href=&#34;https://xmpp.org/about/technology-overview.html&#34;&gt;https://xmpp.org/about/technology-overview.html&lt;/a&gt;&lt;/cite&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;What separates SQLite from other relational databases management systems (RDBMS) is it embeds itself with the program rather than relying on a client-server model. This means no additional server is needed to run and manage this database. We will use a special tool to open the &lt;code&gt;clientDB.db&lt;/code&gt; file and one of my favorite is &lt;mark&gt;DB Browser for SQLite&lt;/mark&gt;. Open up the file and go to the &lt;code&gt;BROWSE DATA&lt;/code&gt; tab.&lt;/p&gt;





  











&lt;figure id=&#34;figure-database-opened-by-db-browser&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/nsa2019/003task3/database.png&#34; data-caption=&#34;Database opened by DB Browser&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/nsa2019/003task3/database.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Database opened by DB Browser
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;This database has 3 tables: clients, contacts, and messages. The contacts and messages tables have no data, so we&amp;rsquo;ll focus on the clients table which has 1 row of input. The row has plenty of attribute columns, but there are two that stand out, the &lt;code&gt;xsip&lt;/code&gt; and &lt;code&gt;asip&lt;/code&gt;. These columns possess what seems to be domain names for our potential server targets.&lt;/p&gt;
&lt;p&gt;We can now use these domain names to perform a DNS lookup to determine the IP addresses by using the &lt;code&gt;dig&lt;/code&gt; command on each of them in the terminal.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ dig register.terrortime.app

 OPT PSEUDOSECTION:
 EDNS: version: 0, flags:; udp: 4096
 QUESTION SECTION:
 register.terrortime.app.	IN	A

 ANSWER SECTION:
register.terrortime.app. 3600	IN	CNAME	codebreaker.ltsnet.net.
codebreaker.ltsnet.net.	300	IN	A	54.197.185.236  &amp;lt;--- OAUTH IP

 Query time: 126 msec
 SERVER: 192.168.254.254#53(192.168.254.254)
 WHEN: Fri Jul 03 14:32:14 CDT 2020
 MSG SIZE  rcvd: 104
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ dig chat.terrortime.app

  OPT PSEUDOSECTION:
 EDNS: version: 0, flags:; udp: 4096
 QUESTION SECTION:
 chat.terrortime.app.		IN	A

 ANSWER SECTION:
chat.terrortime.app.	3600	IN	A	54.91.5.130 &amp;lt;--- XMPP IP

 Query time: 82 msec
 SERVER: 192.168.254.254#53(192.168.254.254)
 WHEN: Fri Jul 03 14:34:02 CDT 2020
 MSG SIZE  rcvd: 64
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Tip: Other command line binaries exist to perform a DNS lookup such as &lt;code&gt;host&lt;/code&gt;, &lt;code&gt;nslookup&lt;/code&gt;, and &lt;code&gt;ping&lt;/code&gt;. Try them out and see how the output differs from &lt;code&gt;dig&lt;/code&gt;.
  &lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Task 4</title>
      <link>https://vengaza.github.io/ctf/nsacodebreaker2019/004task4/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>https://vengaza.github.io/ctf/nsacodebreaker2019/004task4/</guid>
      <description>&lt;h2 id=&#34;schemes&#34;&gt;Schemes&lt;/h2&gt;
&lt;p&gt;Category: Cryptography; Reverse Engineering; Language Analysis&lt;/p&gt;
&lt;p&gt;While analyzing the TerrorTime SQLite database found on the terrorist’s device, analysts discovered that the database has cached credentials but requires a pin to log in. If we can determine how the credentials are protected and find a way to recover the pin, we should be able to masquerade as the arrested terrorist. Perform reverse engineering to identify how the terrorist’s credentials are protected and submit the terrorist&amp;rsquo;s Client ID and Client Secret. Once you have uncovered their credentials, masquerade (i.e., login) as him using the TerrorTime app. Review their chat history and assess additional information regarding their organization. Though the app encrypts messages back and forth, the terrorists have previously spoken in some form of code to ensure their plans were protected. To prove completion of this task, you will need to analyze the terrorist&amp;rsquo;s conversation history in order to uncover/deduce the following information:&lt;/p&gt;
&lt;h3 id=&#34;flags&#34;&gt;Flags&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; Cell Leader Username (ASCII)&lt;/li&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; Action Date (Unix timestamp, integer)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;h3 id=&#34;commands&#34;&gt;Commands&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;jadx -d out &amp;lt;FILE.APK&amp;gt;&lt;/code&gt; - Converts DEX -&amp;gt; JAR -&amp;gt; Java (Source)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;date -j -f &amp;quot;%Y:%m:%d %H:%M:%S&amp;quot; &amp;lt;&#39;YYYY:MM:DD HH:MM:SS&#39;&amp;gt; +%s&lt;/code&gt; - Print out unix timestamp for date&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;tools&#34;&gt;Tools&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href=&#34;https://developer.android.com/studio&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Android Studio&lt;/a&gt; - Google IDE for Android&lt;/li&gt;
&lt;li&gt;
&lt;a href=&#34;https://github.com/skylot/jadx&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;JADX&lt;/a&gt; - Dex to Java decompiler&lt;/li&gt;
&lt;li&gt;
&lt;a href=&#34;https://ghidra-sre.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ghidra&lt;/a&gt; - NSA&amp;rsquo;s software reverse engineering suite (Optional)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;analysis&#34;&gt;Analysis&lt;/h3&gt;
&lt;p&gt;Let the fun begin! The goal of this challenge is to hack our way into the terrorist&amp;rsquo;s account on the TerrorTime application to review chat information for pertinent information. Before we start, we need to set up an emulation environment to run the TerrorTime APK. I recommend using the Android Virtual Device (AVD) manager within &lt;mark&gt;Android Studio&lt;/mark&gt;. AVD setup documentation can be found at the following link:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://developer.android.com/studio/run/emulator&#34;&gt;https://developer.android.com/studio/run/emulator&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    &lt;em&gt;* When it comes to choosing an Android version, I chose to use Android 9.0 Pie (SDK 28) as per the challenge setup instructions. However, an SDK version between 26 and 27 can also be used based on information in the manifest file.&lt;/em&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;Once the emulator is up and running, drag the APK file onto the emulator to install the TerrorTime application. Before running the application, make sure to use the File Device Explorer within Android Studio to replace the emulator&amp;rsquo;s TerrorTime &lt;code&gt;clientDB.db&lt;/code&gt; file with the one from the previous task. The file can be located at &lt;code&gt;DATA &amp;gt; DATA &amp;gt; COM.BADGUY.TERRORTIME &amp;gt; DATABASES &amp;gt; CLIENTDB.DB&lt;/code&gt;.&lt;/p&gt;





  











&lt;figure id=&#34;figure-starting-the-terrortime-apk-on-the-avd-emulator&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/nsa2019/004task4/emulation.gif&#34; data-caption=&#34;Starting the TerrorTime APK on the AVD emulator&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/nsa2019/004task4/emulation.gif&#34; alt=&#34;&#34; width=&#34;30%&#34; &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Starting the TerrorTime APK on the AVD emulator
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;When we start the application, we are presented with a login screen and asked to enter the client ID along with a pin. We have a client ID from the Task 3, but the potential pin(the blob data within checkpin) is encoded using an unknown format. We do know that it is 32 bytes (256 bits) in size based on the information DB Browser provided. I ended up fuzzing the login to see how the application would react, and it reveals the pin must be 6 digits in length. This is another vital clue because it means the pin is susceptible to being bruteforced.&lt;/p&gt;
&lt;p&gt;$$ \text{10 choices for each pin digit with replacement} = 0-9$$
$$  10 \times 10 \times 10 \times 10 \times 10 \times 10 = 10^{6} $$
$$ 1000000 \text{ combinations} $$&lt;/p&gt;
&lt;p&gt;If we could determine how the pin was being transformed (hashed) to be stored in the database, we could create a script to generate the &lt;code&gt;hash&lt;/code&gt; of every single pin value until it matched what was in our database. When we find a match, we have the pin. Let&amp;rsquo;s look deeper into the APK using &lt;mark&gt;JADX&lt;/mark&gt;, a Dex to Java decompiler, to see if we can find the more information about the checkpin value within the source code.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# Outputs Java source code to out folder
$ jadx -d out terrortime.apk 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This command outputs a folder named &lt;code&gt;out&lt;/code&gt; which contains the decompiled source code from the &lt;code&gt;APK&lt;/code&gt;. Keep in mind that this is not a perfect process and the output will contain portions of code which were unable to be decompiled. Navigate to the &lt;code&gt;OUT &amp;gt; SOURCES &amp;gt; COM &amp;gt; BADGUY &amp;gt; TERRORTIME&lt;/code&gt; folder. This folder contains the various classes that the APK uses. After a quick scan of the file names, I decided to look at the &lt;code&gt;LoginActivity.java&lt;/code&gt; file to see if I could understand how the login page was verifying the pin input.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//LoginActivity.java
if (this.success) {
    this.client.generateSymmetricKey(); &amp;lt;---- &amp;quot;Possible pin encoding or encryption&amp;quot;
    this.client.validateAccessToken(activity.getApplicationContext());
    Log.d(&amp;quot;LOGINACTIVITY&amp;quot;, &amp;quot;Token request successful. &amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let&amp;rsquo;s check the &lt;code&gt;Client.java&lt;/code&gt; class and learn more about this function.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-java&#34;&gt;//Client.java
public final SecretKey generateSymmetricKey() throws Exception {
  String ePin = this.encryptPin.getValue();
  if (!this.encryptPin.isDefaultValue()) {
      byte[] salt = this.checkPin.getValue();
      byte[] hash = null;
      
      try {
          // Pin is UTF8 encoded, converted to byte array, and hashed with SHA256
          hash = MessageDigest.getInstance(&amp;quot;SHA-256&amp;quot;).digest(ePin.getBytes(StringUtils.UTF8));
          if (salt == null) {
              salt = hash;
              // Side Note: The pin hash appears to be used as a salt for an encryption
              this.checkPin.setValue(salt);
          }
      }
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A quick Google search reveals the Java &lt;code&gt;digest&lt;/code&gt; method from the &lt;code&gt;MessageDigest&lt;/code&gt; class returns an array of 32 bytes for the resulting SHA256 hash. This matches the format of the checkpin blob from the database and we can reasonably assume that the byte representation is the output of the SHA256 hashing function. Let&amp;rsquo;s write a quick script to test this theory:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;#! python3
from hashlib import sha256

targetHash = &amp;quot;925e82c7069676d7d6e2ae4a114c4b327f3022f5e025189d07baf7c935725ce8&amp;quot;
pin = -1

# Brute force each pin combo from 000000 - 999999
# Time = O(N)
# Space = O(1)
for i in range(1000000):
    candidate = str(i).zfill(6)
    candidateHash= sha256(candidate.encode(&amp;quot;utf-8&amp;quot;)).hexdigest()
    if candidateHash == targetHash:
        pin = candidate
        break

print(&amp;quot;Pin not found&amp;quot;) if pin == -1 else print(&amp;quot;Pin: {}&amp;quot;.format(pin))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We now have the client ID and pin. Let&amp;rsquo;s try to login into the application once again.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Client ID: &lt;a href=&#34;mailto:zoe--vhost-3823@terrortime.app&#34;&gt;zoe--vhost-3823@terrortime.app&lt;/a&gt; &lt;br&gt;
Client Pin: 021086&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Success! We now have access to Zoe&amp;rsquo;s TerrorTime account and discover 2 of her contacts, Joseph and Emanuel. Each contact has a chat history log stored and it is reasonable to assume Emanuel is the person of authority in the conversation compared to Joseph.&lt;/p&gt;
&lt;p&gt;




  











&lt;figure id=&#34;figure-chat-history-with-emanuel&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/nsa2019/004task4/emanuelChat.png&#34; data-caption=&#34;Chat history with Emanuel&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/nsa2019/004task4/emanuelChat.png&#34; alt=&#34;&#34; width=&#34;30%&#34; &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Chat history with Emanuel
  &lt;/figcaption&gt;


&lt;/figure&gt;






  











&lt;figure id=&#34;figure-chat-history-with-joseph&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/nsa2019/004task4/josephChat.png&#34; data-caption=&#34;Chat history with Joseph&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/nsa2019/004task4/josephChat.png&#34; alt=&#34;&#34; width=&#34;30%&#34; &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Chat history with Joseph
  &lt;/figcaption&gt;


&lt;/figure&gt;
&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Cell Leader Username: &lt;a href=&#34;mailto:emanuel--vhost-3823@terrortime.app&#34;&gt;emanuel--vhost-3823@terrortime.app&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;The last piece of this task is finding the date-time group of the proposed attack. The chat messages indicate they are planning to meet up on December 28, 2019 @ 2012 (delivering wine to the wedding 4 days before New Year&amp;rsquo;s Day). However, we need the Unix timestamp of the date. We&amp;rsquo;ll use the &lt;code&gt;date&lt;/code&gt; command in MacOS to calculate the value:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# Output the Unix timestamp for December 28, 2019 @ 20:12:00
$ date -j -f &amp;quot;%Y:%m:%d %H:%M:%S&amp;quot; &#39;2019:12:28 20:12:00&#39; +%s
1577585520
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Did You Know?&lt;br&gt;
The Year 2038 problem (also called Y2038 or Y2k38 or Unix Y2K) relates to representing time in many digital systems as the number of seconds passed since 00:00:00 UTC on 1 January 1970 and storing it as a signed 32-bit integer. Such implementations cannot encode times after 03:14:07 UTC on 19 January 2038.
  &lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Task 5</title>
      <link>https://vengaza.github.io/ctf/nsacodebreaker2019/005task5/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>https://vengaza.github.io/ctf/nsacodebreaker2019/005task5/</guid>
      <description>&lt;h2 id=&#34;masquerade-vulnerability-analysis&#34;&gt;Masquerade (Vulnerability Analysis)&lt;/h2&gt;
&lt;p&gt;The app uses a bespoke application of the OAUTH protocol to authorize and authenticate TerrorTime users to the chat service. Our intelligence indicates that individual terrorists are provided phones with TerrorTime installed and pre-registered to them. They simply need to enter their username and secret PIN to access the chat service, which uses OAUTH behind the scenes to generate a unique token that is used for authentication. This is a non-standard way of using the protocol, but they believe it to be superior to normal password-based authentication since a unique token is used per login vs. a static password. Whether that is indeed the case is up to you to analyze and assess for possible vulnerabilities. Our forensics team recovered a deleted file from the terrorist&amp;rsquo;s hard drive that may aid in your analysis.&lt;/p&gt;
&lt;p&gt;Through other intelligence means, we know that the arrested terrorist is a member of one of many cells in a larger organization. He has shown no signs of someone who is acting in a leadership role &amp;ndash; he simply carries out orders given to him from his cell leader, who is likely relaying information from the top-level organizational leader. To uncover information from the cell leader’s conversations, we need access to their account. The messages are end-to-end encrypted, so without the leader&amp;rsquo;s private key we won&amp;rsquo;t be able to decrypt his messages, but we may be able to learn more about the members of the cell and the organization&amp;rsquo;s structure. Analyze the client and server-side components of the authentication process and find a way to masquerade as arbitrary users without knowing their credentials. Take advantage of this vulnerability and masquerade as the cell leader. Access and review the cell leader’s relevant information stored on the server. Use this information to identify and submit the top-level organizational leader’s username and go a step further and submit a copy of the last (still encrypted) message body from the organization leader’s chat history. It’s suggested to complete task 4 before attempting this task as task 4 aids in discovering the cell leader’s identity.&lt;/p&gt;
&lt;h3 id=&#34;flags&#34;&gt;Flags&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; The username of the Top-Level Organization Leader (ASCII)&lt;/li&gt;
&lt;li&gt;&lt;input disabled=&#34;&#34; type=&#34;checkbox&#34;&gt; Last encrypted message body from the Top-Level Organization Leader&amp;rsquo;s chat history (JSON)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
&lt;a href=&#34;https://codebreaker.ltsnet.net/files/task5/auth_verify.pyc?1593563870&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Task Files&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;h3 id=&#34;commands&#34;&gt;Commands&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;apkanlyzer -h manifest permissions &amp;lt;FILE.APK&amp;gt;&lt;/code&gt; - Print application permissions&lt;/li&gt;
&lt;li&gt;&lt;code&gt;File-GetHash&lt;/code&gt; - compute and check SHA256 message digest (Windows)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;tools&#34;&gt;Tools&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href=&#34;https://developer.android.com/studio&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Android Studio&lt;/a&gt; - Google IDE for Android&lt;/li&gt;
&lt;li&gt;
&lt;a href=&#34;https://ghidra-sre.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ghidra&lt;/a&gt; - NSA&amp;rsquo;s software reverse engineering suite (Optional)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;analysis&#34;&gt;Analysis&lt;/h3&gt;
&lt;p&gt;Coming soon&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Welcome</title>
      <link>https://vengaza.github.io/post/welcome/</link>
      <pubDate>Mon, 22 Jun 2020 00:31:21 -0500</pubDate>
      <guid>https://vengaza.github.io/post/welcome/</guid>
      <description>&lt;p&gt;It has been a long time coming for me to take the time to create a personal portfolio page. I have been putting this off for years because I was so focused on finding the &amp;ldquo;perfect&amp;rdquo; layout but I have finally come to the conclusion this does not exist! It was time to just take a leap of faith and dive into completing the project.&lt;/p&gt;
&lt;p&gt;Why did I want to build this though? I have been using my Github repository as a makeshift portfolio and to be honest, it is not all that inspiring to share with others. Even with a fantastic README.md, Github is just plain boring to peruse. I needed a better way to show off my projects and accomplishments. I needed to create a portfolio that people wanted to explore and make it easy for them to learn about me. I also figured this could be an opportunity to share a piece of myself with the world. A chance to share the knowledge I have come across from studying, reading, and building. Who knows, maybe this will inspire someone else&amp;hellip;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Enigma</title>
      <link>https://vengaza.github.io/project/enigma/</link>
      <pubDate>Tue, 26 May 2020 17:27:43 -0500</pubDate>
      <guid>https://vengaza.github.io/project/enigma/</guid>
      <description></description>
    </item>
    
    <item>
      <title>TreasureHunt</title>
      <link>https://vengaza.github.io/project/treasurehunt/</link>
      <pubDate>Tue, 26 May 2020 16:08:53 -0500</pubDate>
      <guid>https://vengaza.github.io/project/treasurehunt/</guid>
      <description>&lt;p&gt;This is my first foray into the world of UI/UX design and I have to say it was very rewarding. It was refreshing to to approach the project from the design perspective and experiment with various tools to create high fidelity mockups. The project was created using Adobe XD and the project link is active if you want to check it out!&lt;/p&gt;
&lt;p&gt;Introduction:&lt;/p&gt;
&lt;p&gt;There is nothing that ignites our inner imagination like the word treasure. Many people grow up watching, listening, and reading fantastic tales of treasure hunting expeditions which lead to unimaginable wealth or power. The real allure of these adventures tends to reside in the journey to the treasure rather than just the treasure itself. The proverbial “thrill of the hunt” keeps both treasure seekers and observers alike engaged by playing on the inquisitiveness and curiosity of human nature.&lt;/p&gt;
&lt;p&gt;However, In a world that has become increasingly connected through technological advances, it may sometimes feel as if there are no treasures left to discover and no more swashbuckling adventures to be had. TreasureHunt aims to defeat this notion by bringing people of all ages together to adventure once again. This application creates a significant usability problem because it must find a way to capture the magic of a treasure hunting experience and deliver it as a mobile application. The feeling of wonder and excitement is a fragile one, though, and can easily be lost to frustration with unintuitive UI elements and feelings of inability to continue exploring. We will work with diverse users and iterate based on the surveys we create to ensure our user experience is not sullied or cut short by frustration.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Ghidra</title>
      <link>https://vengaza.github.io/talk/ghidra/</link>
      <pubDate>Sun, 21 Apr 2019 17:35:45 -0500</pubDate>
      <guid>https://vengaza.github.io/talk/ghidra/</guid>
      <description>&lt;p&gt;Coming soon&amp;hellip;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>PX4</title>
      <link>https://vengaza.github.io/talk/untitled-folder/</link>
      <pubDate>Sun, 21 Apr 2019 17:35:45 -0500</pubDate>
      <guid>https://vengaza.github.io/talk/untitled-folder/</guid>
      <description>&lt;p&gt;Coming soon&amp;hellip;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Ukdah</title>
      <link>https://vengaza.github.io/project/ukdah/</link>
      <pubDate>Sun, 21 Apr 2019 17:35:45 -0500</pubDate>
      <guid>https://vengaza.github.io/project/ukdah/</guid>
      <description>&lt;p&gt;




  
  











&lt;figure &gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/project/ukdah/demo_hu02826cf75b135d27ab552549182d3fd3_3006296_2000x2000_fit_lanczos.gif&#34; &gt;


  &lt;img data-src=&#34;https://vengaza.github.io/project/ukdah/demo_hu02826cf75b135d27ab552549182d3fd3_3006296_2000x2000_fit_lanczos.gif&#34; class=&#34;lazyload&#34; alt=&#34;&#34; width=&#34;600&#34; height=&#34;349&#34;&gt;
&lt;/a&gt;



&lt;/figure&gt;

Check out the full project at my Github &lt;a href=&#34;https://github.com/venGaza/ukdah&#34;&gt;https://github.com/venGaza/ukdah&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Introduction: Awards play a critical role in recognizing employee accomplishments and boosting morale within an organization but most systems are out of date or too reliant upon an extensive human resources staff. The Ukdah team aims to solve this problem by working on a database-backed, responsive website which can be used to track and deliver employee recognition awards. The website will streamline the recognition process by giving users the ability to send recognition to those that they feel are deserving, and it will also provide critical business intelligence data to users overseeing the management of their awards program. Every employee deserves to be recognized for the value he/she brings to their respective organizations while organizations deserve a simple and effective solution to accomplish this. The Ukdah employee recognition website will lead the way!&lt;/p&gt;
&lt;p&gt;User Perspective: The users of this website will be employees of larger enterprise organizations who are having trouble managing their awards recognition process. These users can be split into two groups which include basic users who are authorized to give out rewards and admin users who serve in a managerial role to oversee the awards program for their entire enterprise. Both users will first encounter an authentication process where they will have to sign into an account, or create one if they have not done so yet. Basic users will need to submit a signature image in order to complete their account sign up since the signature will need to be used for their certificates. The authentication system will also feature a forgotten password recovery process which will email users a forgotten password to the registered email address. Once logged in, a basic user will have the ability to create an award. This will require the user to enter some basic information about the employee being generated and then the system will generate the certificate and email it to the awardee in a PDF format. Basic users will be able to see all the certificates they have awarded and will be able to delete them if they change their mind. When an admin user log in, they will not have the ability to create any awards. Instead, they will be presented with various data statistics in regards to the awards such as amounts, regions, and awarders. The admin user will also have the ability to add/edit/delete both other admin users and basic users.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
