<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Overview | venGaza</title>
    <link>https://vengaza.github.io/ctf/nsacodebreaker2019/</link>
      <atom:link href="https://vengaza.github.io/ctf/nsacodebreaker2019/index.xml" rel="self" type="application/rss+xml" />
    <description>Overview</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><lastBuildDate>Sun, 09 Sep 2018 00:00:00 +0000</lastBuildDate>
    <image>
      <url>https://vengaza.github.io/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png</url>
      <title>Overview</title>
      <link>https://vengaza.github.io/ctf/nsacodebreaker2019/</link>
    </image>
    
    <item>
      <title>Task 1</title>
      <link>https://vengaza.github.io/ctf/nsacodebreaker2019/001task1/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>https://vengaza.github.io/ctf/nsacodebreaker2019/001task1/</guid>
      <description>&lt;h2 id=&#34;it-begins-network-traffic-analysis&#34;&gt;It Begins! (Network Traffic Analysis)&lt;/h2&gt;
&lt;p&gt;There are many challenges that we will need to overcome in order to exploit TerrorTime. The first is that we do not yet have a copy of it. We have learned few details through intelligence sources, but the terrorists have managed to keep the app hidden. It is not publicly available on any App Store. Fortunately, as part of a recent military operation, specialized collection gear was forward deployed near the terrorist&amp;rsquo;s area of operations. This resulted in a trove of collected traffic and we need your help to analyze it. Your first task is to find and extract a copy of the TerrorTime Android Package (APK) file from the packet capture. Submit the APK&amp;rsquo;s SHA256 hash. This will help us search other intelligence sources for connections to users. To test out the app, we also need the registration information their leadership uses to register each client. Analyze the packet capture for this data and submit the registration information for 2 clients (in any order).&lt;/p&gt;
&lt;p&gt;
&lt;a href=&#34;https://codebreaker.ltsnet.net/files/task1/terrortime.pcapng?1593563870&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Task Files&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
&lt;h3 id=&#34;commands&#34;&gt;Commands&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;sha256sum&lt;/code&gt; - compute and check SHA256 message digest (Linux/OSX)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;File-GetHash&lt;/code&gt; - compute and check SHA256 message digest (Windows)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;tools&#34;&gt;Tools&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;a href=&#34;https://www.wireshark.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WireShark&lt;/a&gt; - Network Protocol Analyzer&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;analysis&#34;&gt;Analysis&lt;/h3&gt;
&lt;p&gt;In this challenge, we are given a &lt;code&gt;.pcapng&lt;/code&gt; file which is a packet capture format that contains a dump of data packets caught over a network. We will use &lt;mark&gt;WireShark&lt;/mark&gt;, a network protocol analyzer, to open this file and view the captured data packets.&lt;/p&gt;





  











&lt;figure id=&#34;figure-packets-in-wireshark&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/nsa2019/001task1/packets.png&#34; data-caption=&#34;Packets in wireshark&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/nsa2019/001task1/packets.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Packets in wireshark
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;Even though there are over 9000 packets in this dump, we immediately notice that the 4th packet stands out because the &amp;ldquo;terrorTime&amp;rdquo; name is mentioned in its information section. This packet was sent using an application layer protocol called HTTP. Let&amp;rsquo;s use a Wireshark filter to reduce the noise and list only the packets using the http protocol.&lt;/p&gt;





  











&lt;figure id=&#34;figure-http-packets-in-wireshark&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/nsa2019/001task1/httpPackets.png&#34; data-caption=&#34;HTTP Packets in wireshark&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/nsa2019/001task1/httpPackets.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    HTTP Packets in wireshark
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;9000 packets has now been reduced to 4! There are 2 GET requests with 2 responses which seem to have file objects associated with them. We&amp;rsquo;ll extract and save these files with WireShark: &lt;code&gt;FILE &amp;gt; EXPORT OBJECTS &amp;gt; HTTP&lt;/code&gt;.&lt;/p&gt;





  











&lt;figure id=&#34;figure-extracting-the-http-files&#34;&gt;


  &lt;a data-fancybox=&#34;&#34; href=&#34;https://vengaza.github.io/img/nsa2019/001task1/files.png&#34; data-caption=&#34;Extracting the http files&#34;&gt;


  &lt;img src=&#34;https://vengaza.github.io/img/nsa2019/001task1/files.png&#34; alt=&#34;&#34;  &gt;
&lt;/a&gt;


  
  
  &lt;figcaption&gt;
    Extracting the http files
  &lt;/figcaption&gt;


&lt;/figure&gt;

&lt;p&gt;With the &lt;code&gt;terrortime.apk&lt;/code&gt; in hand, we can now run the &lt;code&gt;sha256sum&lt;/code&gt; command on the APK file to determine its hash value and complete the first task.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ sha256sum terrortime.apk
$ 65f87dfb701694d5b72963e6b707fda6882de72612af59296c255bef00a3699e  terrortime.apk 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In the second task, we need to locate the registration information for 2 clients. Let&amp;rsquo;s investigate the &lt;code&gt;README.developer&lt;/code&gt; file we extracted earlier to see if there are any hints. This file can be opened up using a text editor or you use the &lt;code&gt;cat&lt;/code&gt; command to print the file out to the terminal.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;$ cat
------------------
terrorTime.apk -- Most current version of terrortime APK for android mobile devices
ava--vhost-10@terrortime.app -- First Terrortime test account client id
emmett--vhost-10@terrortime.app -- Second Terrortime test account client id
7rIFNGekGSE6Ai -- First Terrortime test account client secret
BJMwJzGTkKDgB2 -- Second Terrortime test account client secret

Used above client information for testing. See test report in Master.

Dev bobs comments on most recent APK code changes
---------------------------------------------------
(20190613) Beta version of Terrortime app completed. Successfully tested. Waiting for customer feedback.

(20190723) Had to make some notable changes to Terrortime authentication mechanisms based on new Customer requirements (as of this week). Code changes were just committed to Master. Not pretty, but will support future operational needs (didnt ask ...dont want to know the details).

Changes also support recently clarified deployment/use CONOP. App will be installed and pre-configured on mobile device before device is given to associate. Associate must use app as configured to interact with Terrortime chat service and will not be provided plaintext version of credentials required for part of authentication process. App will use its credentials to authenticate itself to Terrortime infrastructure, a process that will be transparent to user/associate. Associate will be provided a PIN that allows him/her to open Terrortime app. 

See design documentation in Master README file for details.

(20190725) After a few bug fixes, Terrortime app passed testing. No rest for the weary.

(20190726) Packaged up and ready to ship! $$$$
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Luckily, the information we are looking for is revealed within this file with 2 accounts listed along with the client secrets. How convenient for us ðŸ˜„&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Task 2</title>
      <link>https://vengaza.github.io/ctf/nsacodebreaker2019/002task2/</link>
      <pubDate>Sun, 05 May 2019 00:00:00 +0100</pubDate>
      <guid>https://vengaza.github.io/ctf/nsacodebreaker2019/002task2/</guid>
      <description>&lt;h2 id=&#34;permissions-mobile-apk-analysis&#34;&gt;Permissions (Mobile APK Analysis)&lt;/h2&gt;
&lt;p&gt;The TerrorTime APK file contains metadata that describes various security properties of the application that we want to know. Since we now have a copy of the APK thanks to the military operation described in Task 1, we need you to identify and submit the following:&lt;/p&gt;
&lt;p&gt;App Permissions
The SHA256 hash of the Code Signing Certificate
The Common Name of the Certificate Signer&lt;/p&gt;
&lt;p&gt;Please note that completion of task 1 is required to complete this task.&lt;/p&gt;
&lt;p&gt;
&lt;a href=&#34;https://codebreaker.ltsnet.net/files/task2/terrortime.pcapng?1593563870&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Task Files&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;solution&#34;&gt;Solution&lt;/h2&gt;
</description>
    </item>
    
  </channel>
</rss>
